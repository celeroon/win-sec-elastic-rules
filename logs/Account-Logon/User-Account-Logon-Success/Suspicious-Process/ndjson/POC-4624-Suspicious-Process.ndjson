{"id": "2f9a0a10-c741-11ee-995e-69549c1dc8c9","name": "User Account Logon Success (Suspicious Process)","tags": ["win-sec"],"interval": "1m","enabled": false,"revision": 1,"description": "This rule detects successful logons initiated by potentially malicious or unauthorized software. Monitoring these events helps identify and prevent unauthorized access, enhancing security by ensuring that only trusted processes request logon actions.","risk_score": 73,"severity": "high","license": "https://github.com/SigmaHQ/Detection-Rule-License/blob/main/LICENSE.Detection.Rules.md","output_index": "","meta": {},"timestamp_override": "event.created","timestamp_override_fallback_disabled": false,"investigation_fields": [],"author": ["celeroon"],"false_positives": [],"from": "now-1m","rule_id": "3359cdde-6177-4a53-9673-bc4fbc4b54ca","max_signals": 100,"risk_score_mapping": [],"severity_mapping": [],"threat": [{"tactic": {"id": "TA0001","reference": "https://attack.mitre.org/tactics/TA0001","name": "Initial Access"},"framework": "MITRE ATT&CK","technique": [{"id": "T1078","reference": "https://attack.mitre.org/techniques/T1078","name": "Valid Accounts","subtechnique": [{"id": "T1078.001","reference": "https://attack.mitre.org/techniques/T1078/001","name": "Default Accounts"},{"id": "T1078.002","reference": "https://attack.mitre.org/techniques/T1078/002","name": "Domain Accounts"}]}]}],"to": "now","references": ["https://learn.microsoft.com/en-us/windows/security/threat-protection/auditing/event-4624#security-monitoring-recommendations"],"version": 1,"exceptions_list": [],"immutable": false,"related_integrations": [],"required_fields": [],"setup": "","type": "query","language": "lucene","index": ["winlogbeat-*"],"query": "event.code: \"4624\" AND NOT process.executable: \"-\" AND NOT process.executable: (/[cC]:\\\\[wW][iI][nN][dD][oO][wW][sS]\\\\[sS][yY][sS][tT][eE][mM]32\\\\[sS][eE][rR][vV][iI][cC][eE][sS].[eE][xX][eE]/ OR /[cC]:\\\\[wW][iI][nN][dD][oO][wW][sS]\\\\[sS][yY][sS][tT][eE][mM]32\\\\[lL][sS][aA][sS][sS].[eE][xX][eE]/ OR /[cC]:\\\\[wW][iI][nN][dD][oO][wW][sS]\\\\[sS][yY][sS][tT][eE][mM]32\\\\[sS][vV][cC][hH][oO][sS][tT].[eE][xX][eE]/ OR /[cC]:\\\\[wW][iI][nN][dD][oO][wW][sS]\\\\[sS][yY][sS][tT][eE][mM]32\\\\[wW][iI][nN][lL][oO][gG][oO][nN].[eE][xX][eE]/) OR NOT winlog.event_data.ProcessName: (/[cC]:\\\\[wW][iI][nN][dD][oO][wW][sS]\\\\[sS][yY][sS][tT][eE][mM]32\\\\[sS][eE][rR][vV][iI][cC][eE][sS].[eE][xX][eE]/ OR /[cC]:\\\\[wW][iI][nN][dD][oO][wW][sS]\\\\[sS][yY][sS][tT][eE][mM]32\\\\[lL][sS][aA][sS][sS].[eE][xX][eE]/ OR /[cC]:\\\\[wW][iI][nN][dD][oO][wW][sS]\\\\[sS][yY][sS][tT][eE][mM]32\\\\[sS][vV][cC][hH][oO][sS][tT].[eE][xX][eE]/ OR /[cC]:\\\\[wW][iI][nN][dD][oO][wW][sS]\\\\[sS][yY][sS][tT][eE][mM]32\\\\[wW][iI][nN][lL][oO][gG][oO][nN].[eE][xX][eE]/) AND NOT winlog.event_data.ProcessName: \"-\"","filters": [],"actions": []}